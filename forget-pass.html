<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Required meta tags-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="au theme template">
    <meta name="author" content="Hau Nguyen">
    <meta name="keywords" content="au theme template">

    <!-- Title Page-->
    <title>Forget Password</title>

    <!-- Fontfaces CSS-->
    <link href="css/font-face.css" rel="stylesheet" media="all">
    <link href="vendor/fontawesome-7.0.1/css/all.min.css" rel="stylesheet" media="all">
    <link href="vendor/mdi-font/css/material-design-iconic-font.min.css" rel="stylesheet" media="all">

    <!-- Bootstrap CSS-->
    <link href="vendor/bootstrap-5.3.8.min.css" rel="stylesheet" media="all">

    <!-- Vendor CSS-->
    <link href="css/aos.css" rel="stylesheet" media="all">
    <link href="vendor/css-hamburgers/hamburgers.min.css" rel="stylesheet" media="all">
    <link href="css/swiper-bundle-11.2.10.min.css" rel="stylesheet" media="all">
    <link href="vendor/perfect-scrollbar/perfect-scrollbar-1.5.6.css" rel="stylesheet" media="all">

    <!-- Main CSS-->
    <link href="css/theme.css" rel="stylesheet" media="all">

</head>

<body>
    <div class="page-wrapper">
        <div class="page-content--bge5">
            <div class="container">
                <div class="login-wrap">
                    <div class="login-content">
                        <div class="login-logo">
                            <a href="#">
                                <img src="images/icon/logo.png" alt="CoolAdmin">
                            </a>
                        </div>
                        <div class="login-form">
                            <form id="resetForm" onsubmit="event.preventDefault(); resetPassword();">
                                <div class="form-group">
                                    <label>Email Address</label>
                                    <input class="au-input au-input--full" type="email" id="email" name="email"
                                        placeholder="Email" required>
                                </div>

                                <div class="form-group">
                                    <label>New Password</label>
                                    <input class="au-input au-input--full" type="password" id="newPassword"
                                        name="newPassword" placeholder="Password Baru" required>
                                </div>

                                <button id="resetBtn" class="au-btn au-btn--block au-btn--green"
                                    style="margin-top: 10px;" type="submit">
                                    Reset Password
                                </button>
                            </form>
                            <div class="register-link">
                                <p>Remember Password? <a href="login.html">Login Here!</a></p>
                            </div>


                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- Bootstrap 5 JS-->
    <!-- Jquery JS-->
    <script src="js/vanilla-utils.js"></script>
    <!-- Bootstrap JS-->
    <script src="vendor/bootstrap-5.3.8.bundle.min.js"></script>
    <!-- Vendor JS       -->
    <script src="vendor/perfect-scrollbar/perfect-scrollbar-1.5.6.min.js"></script>
    <script src="vendor/chartjs/chart.umd.js-4.5.0.min.js"></script>

    <script>
        const scriptURL = "https://script.google.com/macros/s/AKfycbwyutAXOuSEfy1yItsWsWNCPBzOqyI-lktXPUdizX3H05Bj-syHkbrUIIbWWPGvXDBI8Q/exec";
        const resetBtn = document.getElementById("resetBtn");

        async function resetPassword() {
            const email = document.getElementById("email").value.trim();
            const newPassword = document.getElementById("newPassword").value.trim();

            if (!email || !newPassword) {
                showMessage("⚠️ Email dan password baru wajib diisi!", "warning");
                return;
            }

            // ubah tombol jadi loading
            resetBtn.disabled = true;
            resetBtn.innerHTML = `<i class="fas fa-spinner fa-spin"></i> Sedang memproses...`;

            try {
                const response = await fetch(scriptURL, {
                    method: "POST",
                    body: new URLSearchParams({
                        action: "forgotPassword",
                        email,
                        newPassword
                    })
                });

                const result = await response.json();
                showMessage(result.message, result.success ? "success" : "error");

                if (result.success) document.getElementById("resetForm").reset();

            } catch (error) {
                console.error(error);
                showMessage("❌ Terjadi kesalahan koneksi.", "error");
            } finally {
                resetBtn.disabled = false;
                resetBtn.innerHTML = "Reset Password";
            }
        }

        // Notifikasi pojok bawah
        function showMessage(msg, type = "info") {
            const colors = {
                success: "#4CAF50",
                error: "#f44336",
                warning: "#ff9800",
                info: "#2196F3"
            };

            const div = document.createElement("div");
            div.textContent = msg;
            div.style.position = "fixed";
            div.style.bottom = "20px";
            div.style.right = "20px";
            div.style.background = colors[type];
            div.style.color = "white";
            div.style.padding = "10px 15px";
            div.style.borderRadius = "8px";
            div.style.boxShadow = "0 3px 8px rgba(0,0,0,0.3)";
            div.style.zIndex = "9999";
            div.style.transition = "opacity 0.3s ease";
            document.body.appendChild(div);
            setTimeout(() => { div.style.opacity = "0"; setTimeout(() => div.remove(), 300); }, 2000);
        }
    </script>


    <!-- Main JS-->
    <script src="js/bootstrap5-init.js"></script>
    <script src="js/main-vanilla.js"></script>
    <script src="js/swiper-bundle-11.2.10.min.js"></script>
    <script src="js/aos.js"></script>
    <script src="js/modern-plugins.js"></script>

</body>

</html>
<!-- end document-->