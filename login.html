<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Required meta tags-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="au theme template">
    <meta name="author" content="Hau Nguyen">
    <meta name="keywords" content="au theme template">

    <!-- Title Page-->
    <title>Login</title>

    <!-- Fontfaces CSS-->
    <link href="css/font-face.css" rel="stylesheet" media="all">
    <link href="vendor/fontawesome-7.0.1/css/all.min.css" rel="stylesheet" media="all">
    <link href="vendor/mdi-font/css/material-design-iconic-font.min.css" rel="stylesheet" media="all">

    <!-- Bootstrap CSS-->
    <link href="vendor/bootstrap-5.3.8.min.css" rel="stylesheet" media="all">

    <!-- Vendor CSS-->
    <link href="css/aos.css" rel="stylesheet" media="all">
    <link href="vendor/css-hamburgers/hamburgers.min.css" rel="stylesheet" media="all">
    <link href="css/swiper-bundle-11.2.10.min.css" rel="stylesheet" media="all">
    <link href="vendor/perfect-scrollbar/perfect-scrollbar-1.5.6.css" rel="stylesheet" media="all">

    <!-- Main CSS-->
    <link href="css/theme.css" rel="stylesheet" media="all">

</head>

<body>
    <div class="page-wrapper">
        <div class="page-content--bge5">
            <div class="container">
                <div class="login-wrap">
                    <div class="login-content">
                        <div class="login-logo">
                            <a href="#">
                                <img src="images/icon/logo.png" alt="CoolAdmin">
                            </a>
                        </div>
                        <div class="login-form">
                            <form onsubmit="event.preventDefault(); loginUser();">
                                <div class="form-group">
                                    <label>Email atau NIK Karyawan</label>
                                    <input class="au-input au-input--full" type="text" id="identifier"
                                        placeholder="Email atau NIK" required>
                                </div>

                                <div class="form-group">
                                    <label>Password</label>
                                    <input class="au-input au-input--full" type="password" id="password"
                                        placeholder="Password" required>
                                </div>

                                <div class="form-group">
                                    <label>Pilih Cabang</label>
                                    <select class="au-input au-input--full" id="role" style="height: 40px;" required>
                                        <option value="">-- Pilih Cabang --</option>
                                        <option value="MAKASSAR">MAKASSAR</option>
                                        <option value="PALU">PALU</option>
                                        <option value="PONTIANAK">PONTIANAK</option>
                                        <option value="JAYAPURA">JAYAPURA</option>
                                        <option value="BANJARMASIN">BANJARMASIN</option>
                                        <option value="KENDARI">KENDARI</option>
                                        <option value="SORONG">SORONG</option>
                                        <option value="SAMARINDA">SAMARINDA</option>
                                        <option value="BULUNGAN">BULUNGAN</option>
                                        <option value="CILEGON">CILEGON</option>
                                        <option value="SAMARINDA">SAMARINDA</option>
                                        <option value="BALIKPAPAN">BALIKPAPAN</option>
                                        <option value="GORONTALO">GORONTALO</option>
                                    </select>
                                </div>

                                <div  style="margin-top: 5px;">
                                    <label>
                                        
                                    </label>
                                   <label style="float: right;">
    <a href="#" onclick="alert('Silahkan hubungi admin jika ingin merubah password.'); return false;">
        Forgot Password?
    </a>
</label>

                                </div>

                                <button class="au-btn au-btn--block au-btn--green" type="submit"
                                    style="margin-top: 10px;">Login</button>
                            </form>


                            <div class="register-link">
                                <!-- <p>
                                    Belum Punya Akun?
                                    <a href="register.html">Register Here!</a>
                                </p> -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- Jquery JS-->
    <script src="js/vanilla-utils.js"></script>
    <!-- Bootstrap JS-->
    <script src="vendor/bootstrap-5.3.8.bundle.min.js"></script>
    <!-- Vendor JS       -->
    <script src="vendor/perfect-scrollbar/perfect-scrollbar-1.5.6.min.js"></script>
    <script src="vendor/chartjs/chart.umd.js-4.5.0.min.js"></script>

    <script>
        const scriptURL = "https://script.google.com/macros/s/AKfycbwyutAXOuSEfy1yItsWsWNCPBzOqyI-lktXPUdizX3H05Bj-syHkbrUIIbWWPGvXDBI8Q/exec";

        const loginBtn = document.querySelector(".au-btn--green");

        async function loginUser() {
            const identifier = document.getElementById("identifier").value.trim();
            const password = document.getElementById("password").value.trim();
            const role = document.getElementById("role").value.trim();

            if (!identifier || !password || !role) {
                showMessage("⚠️ Mohon isi semua kolom.", "warning");
                return;
            }

            loginBtn.disabled = true;
            loginBtn.innerHTML = `<i class="fas fa-spinner fa-spin"></i> Sedang masuk...`;

            try {
                const response = await fetch(scriptURL, {
                    method: "POST",
                    headers: { "Content-Type": "application/x-www-form-urlencoded" },
                    body: new URLSearchParams({
                        action: "login",
                        identifier,
                        password,
                        role
                    })
                });

                const result = await response.json();

                if (result.success) {
                    showMessage("✅ Login berhasil!", "success");
                    localStorage.setItem("user", JSON.stringify(result.user));
                    setTimeout(() => window.location.href = "index.html", 1000);
                } else {
                    showMessage(result.message, "error");
                }

            } catch (error) {
                console.error(error);
                showMessage("❌ Gagal menghubungi server.", "error");
            } finally {
                loginBtn.disabled = false;
                loginBtn.innerHTML = "Sign In";
            }
        }

        function showMessage(msg, type = "info") {
            const colors = {
                success: "#4CAF50",
                error: "#f44336",
                warning: "#ff9800",
                info: "#2196F3"
            };

            const div = document.createElement("div");
            div.textContent = msg;
            div.style.position = "fixed";
            div.style.bottom = "20px";
            div.style.right = "20px";
            div.style.background = colors[type];
            div.style.color = "white";
            div.style.padding = "10px 15px";
            div.style.borderRadius = "8px";
            div.style.boxShadow = "0 3px 8px rgba(0,0,0,0.3)";
            div.style.zIndex = "9999";
            div.style.transition = "opacity 0.3s ease";
            document.body.appendChild(div);
            setTimeout(() => { div.style.opacity = "0"; setTimeout(() => div.remove(), 300); }, 1500);
        }
    </script>




    <!-- Main JS-->
    <script src="js/bootstrap5-init.js"></script>
    <script src="js/main-vanilla.js"></script>
    <script src="js/swiper-bundle-11.2.10.min.js"></script>
    <script src="js/aos.js"></script>
    <script src="js/modern-plugins.js"></script>

</body>

</html>
<!-- end document-->