<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Required meta tags-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="au theme template">
    <meta name="author" content="Hau Nguyen">
    <meta name="keywords" content="au theme template">

    <!-- Title Page-->
    <title>Dashboard</title>

    <!-- Fontfaces CSS-->
    <link href="css/font-face.css" rel="stylesheet" media="all">
    <link href="vendor/fontawesome-7.0.1/css/all.min.css" rel="stylesheet" media="all">
    <link href="vendor/mdi-font/css/material-design-iconic-font.min.css" rel="stylesheet" media="all">



    <!-- Bootstrap CSS-->
    <link href="vendor/bootstrap-5.3.8.min.css" rel="stylesheet" media="all">

    <!-- Vendor CSS-->
    <link href="css/aos.css" rel="stylesheet" media="all">
    <link href="vendor/css-hamburgers/hamburgers.min.css" rel="stylesheet" media="all">
    <link href="css/swiper-bundle-11.2.10.min.css" rel="stylesheet" media="all">
    <link href="vendor/perfect-scrollbar/perfect-scrollbar-1.5.6.css" rel="stylesheet" media="all">

    <!-- Main CSS-->
    <link href="css/theme.css" rel="stylesheet" media="all">

    <style>
        .overview-box {
            display: flex;
            align-items: left;
            /* sejajarkan vertikal */
            justify-content: flex-start;
            gap: 0.5rem;
            /* jarak antar ikon dan teks */
            min-height: 40px;
            /* samakan tinggi antar box */
        }

        .overview-box .icon {
            font-size: 1.8rem;
            flex-shrink: 0;
            margin-left: -25px;
            /* geser ikon sedikit ke kanan */
        }

        .overview-box .text {
            text-align: left;
        }

        .overview-box h2 {
            margin-bottom: 0.5px;
            text-align: left;
        }

        /* ======== DARK MODE ======== */
        body.dark-mode {
            background-color: #ffffff !important;
            color: #fffefe !important;
        }

        body.dark-mode .card,
        body.dark-mode .header-desktop {
            background-color: #6d6a6a !important;
            color: #ffffff !important;
        }

        body.dark-mode .main-content {
            background-color: #8f8989 !important;
            color: #ffffff !important;
        }

        body.dark-mode a {
            color: #000000 !important;
        }

        body.dark-mode .account-dropdown {
            background-color: #6d6a6a !important;
        }

        body.dark-mode .account-dropdown__item a {
            color: #ffffff !important;
        }

        .switch {
            position: relative;
            display: inline-block;
            width: 90px;
            height: 32px;
        }

        .switch-input {
            display: none;
        }

        .switch-label {
            display: block;
            cursor: pointer;
            border: 2px solid #ccc;
            border-radius: 50px;
            background-color: #f5f5f5;
            text-align: center;
            font-size: 14px;
            line-height: 28px;
            color: #333;
            transition: background-color 0.3s, color 0.3s;
            box-shadow: inset 0 0 4px rgba(0, 0, 0, 0.1);
        }

        .navbar__list li a.active {
            background-color: #e8f0fe;
            /* warna terang seperti highlight */
            color: #1a73e8 !important;
            /* biru agar selaras */
            border-radius: 8px;
            font-weight: 600;
        }

        /* Mode gelap */
        body.dark-mode .navbar__list li a.active {
            background-color: #6d6a6a;
            color: #0a0a0a !important;
            border-radius: 8px;
        }

        /* Perbaiki agar active juga muncul di menu mobile */
        .navbar-mobile__list li a.active {
            background-color: #e8f0fe !important;
            color: #1a73e8 !important;
            border-radius: 8px !important;
            font-weight: 600;
        }

        /* Versi dark mode */
        body.dark-mode .navbar-mobile__list li a.active {
            background-color: #6d6a6a !important;
            color: #0a0a0a !important;
        }
    </style>


</head>

<body>
    <div class="page-wrapper">
        <!-- HEADER MOBILE-->
        <header class="header-mobile d-block d-lg-none">
            <div class="header-mobile__bar">
                <div class="container-fluid">
                    <div class="header-mobile-inner">
                        <a class="logo" href="index.html">
                            <img src="images/icon/logo.png" alt="CoolAdmin" />
                        </a>
                        <button class="hamburger hamburger--slider" type="button">
                            <span class="hamburger-box">
                                <span class="hamburger-inner"></span>
                            </span>
                        </button>
                    </div>
                </div>
            </div>
            <nav class="navbar-mobile">
                <div class="container-fluid">
                    <ul class="navbar-mobile__list list-unstyled">
                        <!-- <li class="has-sub">
                            <a class="js-arrow" href="#">
                                <i class="fas fa-tachometer-alt"></i>Dashboard</a>
                            <ul class="navbar-mobile-sub__list list-unstyled js-sub-list">
                                <li>
                                    <a href="index.html">Dashboard 1</a>
                                </li>
                                <li>
                                    <a href="index2.html">Dashboard 2</a>
                                </li>
                                <li>
                                    <a href="index3.html">Dashboard 3</a>
                                </li>
                                <li>
                                    <a href="index4.html">Dashboard 4</a>
                                </li>
                            </ul>
                        </li> -->
                        <li>
                            <a href="index.html" class="active">
                                <i class="fas fa-tachometer-alt "></i>Dashboard</a>
                        </li>
                        <!-- <li>
                            <a href="chart.html">
                                <i class="fas fa-chart-bar"></i>Charts</a>
                        </li> -->
                       <li>
                            <a href="progresttd.html">
                                <i class="fas fa-tasks"></i>Progres TTD</a>
                        </li>
                        
                        <li>
                            <a href="form.html">
                                <i class="far fa-check-square"></i>Forms</a>
                        </li>

                        <li>
                            <a href="statusdokumen.html">
                                <i class="fas fa-file-alt"></i>Status Dokumen</a>
                        </li>
                        <li>
                            <a href="calendar.html">
                                <i class="fas fa-calendar-alt"></i>Calendar</a>
                        </li>
                        <li>
                            <a href="map.html">
                                <i class="fas fa-map-marker-alt"></i>Maps</a>
                        </li>
                        <li class="has-sub">
                            <a class="js-arrow" href="#">
                                <i class="fas fa-desktop"></i>Account</a>
                            <ul class="navbar-mobile-sub__list list-unstyled js-sub-list">

                                <li id="menuAccountMobile">
                                    <a href="register.html">
                                        <i class="fas fa-user"></i> Register
                                    </a>
                                </li>
                                <!-- <li id="menuAccountMobile1">
                                    <a href="forget-pass.html">
                                        <i class="fas fa-unlock-alt"></i> Forget Password
                                    </a>
                                </li> -->
                                <li id="menuAccountMobile1">
                                    <a href="users.html">
                                        <i class="fas fa-user-edit"></i> Users
                                    </a>
                                </li>
                                <li id="menuAccountMobile2">
                                    <a href="approval.html" >
                                        <i class="fas fa-tasks"></i> Approval
                                    </a>
                                </li>
                                <li>
                                    <a href="profile.html">
                                        <i class="far fa-id-card"></i> Profil Akun
                                    </a>
                                </li>
                                <li>
                                    <a href="login.html">
                                        <i class="fas fa-sign-in-alt"></i> Logout
                                    </a>
                                </li>
                            </ul>

                        </li>
                        <!-- <li class="has-sub">
                            <a class="js-arrow" href="#">
                                <i class="fas fa-desktop"></i>UI Elements</a>
                            <ul class="navbar-mobile-sub__list list-unstyled js-sub-list">
                                <li>
                                    <a href="button.html">Button</a>
                                </li>
                                <li>
                                    <a href="badge.html">Badges</a>
                                </li>
                                <li>
                                    <a href="tab.html">Tabs</a>
                                </li>
                                <li>
                                    <a href="card.html">Cards</a>
                                </li>
                                <li>
                                    <a href="alert.html">Alerts</a>
                                </li>
                                <li>
                                    <a href="progress-bar.html">Progress Bars</a>
                                </li>
                                <li>
                                    <a href="modal.html">Modals</a>
                                </li>
                                <li>
                                    <a href="switch.html">Switchs</a>
                                </li>
                                <li>
                                    <a href="grid.html">Grids</a>
                                </li>
                                <li>
                                    <a href="fontawesome.html">Fontawesome Icon</a>
                                </li>
                                <li>
                                    <a href="typo.html">Typography</a>
                                </li>
                            </ul>
                        </li> -->
                    </ul>
                </div>
            </nav>
        </header>
        <!-- END HEADER MOBILE-->

        <!-- MENU SIDEBAR-->
        <aside class="menu-sidebar d-none d-lg-block">
            <div class="logo">
                <a href="index.html">
                    <img src="images/icon/logo.png" alt="Cool Admin" />
                </a>
            </div>
            <div class="menu-sidebar__content js-scrollbar1">
                <nav class="navbar-sidebar">
                    <ul class="list-unstyled navbar__list">
                        <!-- <li class="active has-sub">
                            <a class="js-arrow" href="#">
                                <i href="index.html" class="fas fa-tachometer-alt"></i>Dashboard</a>
                            <ul class="list-unstyled navbar__sub-list js-sub-list">
                                <li>
                                    <a href="index.html">Dashboard 1</a>
                                </li>
                                <li>
                                    <a href="index2.html">Dashboard 2</a>
                                </li>
                                <li>
                                    <a href="index3.html">Dashboard 3</a>
                                </li>
                                <li>
                                    <a href="index4.html">Dashboard 4</a>
                                </li>
                            </ul>
                        </li> -->
                        <li>
                            <a class="active" href="index.html">
                                <i class="fas fa-tachometer-alt"></i>Dashboard</a>
                        </li>
                        <!-- <li>
                            <a href="chart.html">
                                <i class="fas fa-chart-bar"></i>Charts</a>
                        </li> -->
                        <li>
                            <a href="progresttd.html">
                                <i class="fas fa-tasks"></i>Progres TTD</a>
                        </li>
                        
                        <li>
                            <a href="form.html">
                                <i class="far fa-check-square"></i>Forms</a>
                        </li>

                        <li>
                            <a href="statusdokumen.html">
                                <i class="fas fa-file-alt"></i>Status Dokumen</a>
                        </li>
                        <li>
                            <a href="calendar.html">
                                <i class="fas fa-calendar-alt"></i>Calendar</a>
                        </li>
                        <li>
                            <a href="map.html">
                                <i class="fas fa-map-marker-alt"></i>Maps</a>
                        </li>
                        <li class="has-sub">
                            <a class="js-arrow" href="#">
                                <i class="fas fa-desktop"></i>Account</a>
                            <ul class="list-unstyled navbar__sub-list js-sub-list">

                                <li id="menuAccountDesktop">
                                    <a href="register.html">
                                        <i class="fas fa-user"></i> Register
                                    </a>
                                </li>
                                <!-- <li id="menuAccountDesktop1">
                                    <a href="forget-pass.html">
                                        <i class="fas fa-unlock-alt"></i> Forget Password
                                    </a>
                                </li> -->
                                <li id="menuAccountDesktop1">
                                    <a href="users.html">
                                        <i class="fas fa-user-edit"></i> Users
                                    </a>
                                </li>
                                <li id="menuAccountDesktop2">
                                    <a href="approval.html" >
                                        <i class="fas fa-tasks"></i> Approval
                                    </a>
                                </li>
                                <li>
                                    <a href="profile.html">
                                        <i class="far fa-id-card"></i> Profil Akun
                                    </a>
                                </li>
                                <li>
                                    <a href="login.html">
                                        <i class="fas fa-sign-in-alt"></i> Logout
                                    </a>
                                </li>
                            </ul>

                        </li>
                        <!-- <li class="has-sub">
                            <a class="js-arrow" href="#">
                                <i class="fas fa-desktop"></i>UI Elements</a>
                            <ul class="list-unstyled navbar__sub-list js-sub-list">
                                <li>
                                    <a href="button.html">Button</a>
                                </li>
                                <li>
                                    <a href="badge.html">Badges</a>
                                </li>
                                <li>
                                    <a href="tab.html">Tabs</a>
                                </li>
                                <li>
                                    <a href="card.html">Cards</a>
                                </li>
                                <li>
                                    <a href="alert.html">Alerts</a>
                                </li>
                                <li>
                                    <a href="progress-bar.html">Progress Bars</a>
                                </li>
                                <li>
                                    <a href="modal.html">Modals</a>
                                </li>
                                <li>
                                    <a href="switch.html">Switchs</a>
                                </li>
                                <li>
                                    <a href="grid.html">Grids</a>
                                </li>
                                <li>
                                    <a href="fontawesome.html">Fontawesome Icon</a>
                                </li>
                                <li>
                                    <a href="typo.html">Typography</a>
                                </li>
                            </ul>
                        </li> -->
                    </ul>
                </nav>
            </div>
        </aside>
        <!-- END MENU SIDEBAR-->

        <!-- PAGE CONTAINER-->
        <div class="page-container">
            <!-- HEADER DESKTOP-->
            <header class="header-desktop">
                <div class="section__content section__content--p30">
                    <div class="container-fluid">
                        <div class="header-wrap">
                            <form class="form-header" action="" method="POST">

                            </form>
                            <div class="header-button">
                                <div class="noti-wrap">
                                    <div class="noti__item js-item-menu">
                                        <i class="zmdi zmdi-comment-more"></i>
                                        <span class="quantity">1</span>
                                        <div class="mess-dropdown js-dropdown">
                                            <div class="mess__title">
                                                <p>You have 2 news message</p>
                                            </div>
                                            <div class="mess__item">
                                                <div class="image img-cir img-40">
                                                    <img src="images/icon/avatar-06.jpg" alt="Michelle Moreno" />
                                                </div>
                                                <div class="content">
                                                    <h6>Michelle Moreno</h6>
                                                    <p>Have sent a photo</p>
                                                    <span class="time">3 min ago</span>
                                                </div>
                                            </div>
                                            <div class="mess__item">
                                                <div class="image img-cir img-40">
                                                    <img src="images/icon/avatar-04.jpg" alt="Diane Myers" />
                                                </div>
                                                <div class="content">
                                                    <h6>Diane Myers</h6>
                                                    <p>You are now connected on message</p>
                                                    <span class="time">Yesterday</span>
                                                </div>
                                            </div>
                                            <div class="mess__footer">
                                                <a href="#">View all messages</a>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="noti__item js-item-menu">
                                        <i class="zmdi zmdi-email"></i>
                                        <span class="quantity">1</span>
                                        <div class="email-dropdown js-dropdown">
                                            <div class="email__title">
                                                <p>You have 3 New Emails</p>
                                            </div>
                                            <div class="email__item">
                                                <div class="image img-cir img-40">
                                                    <img src="images/icon/avatar-06.jpg" alt="Cynthia Harvey" />
                                                </div>
                                                <div class="content">
                                                    <p>Meeting about new dashboard...</p>
                                                    <span>Cynthia Harvey, 3 min ago</span>
                                                </div>
                                            </div>
                                            <div class="email__item">
                                                <div class="image img-cir img-40">
                                                    <img src="images/icon/avatar-05.jpg" alt="Cynthia Harvey" />
                                                </div>
                                                <div class="content">
                                                    <p>Meeting about new dashboard...</p>
                                                    <span>Cynthia Harvey, Yesterday</span>
                                                </div>
                                            </div>
                                            <div class="email__item">
                                                <div class="image img-cir img-40">
                                                    <img src="images/icon/avatar-04.jpg" alt="Cynthia Harvey" />
                                                </div>
                                                <div class="content">
                                                    <p>Meeting about new dashboard...</p>
                                                    <span>Cynthia Harvey, January 15, 2025</span>
                                                </div>
                                            </div>
                                            <div class="email__footer">
                                                <a href="#">See all emails</a>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="noti__item js-item-menu">
                                        <i class="zmdi zmdi-notifications"></i>
                                        <span class="quantity">3</span>
                                        <div class="notifi-dropdown js-dropdown">
                                            <div class="notifi__title">
                                                <p>You have 3 Notifications</p>
                                            </div>
                                            <div class="notifi__item">
                                                <div class="bg-c1 img-cir img-40">
                                                    <i class="zmdi zmdi-email-open"></i>
                                                </div>
                                                <div class="content">
                                                    <p>You got a email notification</p>
                                                    <span class="date">January 15, 2025 14:30</span>
                                                </div>
                                            </div>
                                            <div class="notifi__item">
                                                <div class="bg-c2 img-cir img-40">
                                                    <i class="zmdi zmdi-account-box"></i>
                                                </div>
                                                <div class="content">
                                                    <p>Your account has been blocked</p>
                                                    <span class="date">January 15, 2025 14:30</span>
                                                </div>
                                            </div>
                                            <div class="notifi__item">
                                                <div class="bg-c3 img-cir img-40">
                                                    <i class="zmdi zmdi-file-text"></i>
                                                </div>
                                                <div class="content">
                                                    <p>You got a new file</p>
                                                    <span class="date">January 15, 2025 14:30</span>
                                                </div>
                                            </div>
                                            <div class="notifi__footer">
                                                <a href="#">All notifications</a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="account-wrap">
                                    <div class="account-item clearfix js-item-menu">
                                        <div class="image">
                                            <img id="userAvatar" src="images/icon/avatar-01.jpg" alt="User Avatar" />
                                        </div>
                                        <div class="content">
                                            <a class="js-acc-btn" id="userName" href="#">User</a>
                                        </div>
                                        <div class="account-dropdown js-dropdown">
                                            <div class="info clearfix">
                                                <div class="image">
                                                    <a href="#">
                                                        <img id="dropdownAvatar" src="images/icon/avatar-01.jpg"
                                                            alt="User Avatar" />
                                                    </a>
                                                </div>
                                                <div class="content" style="height: 5px; margin-top: -11px;">
                                                    <h5 class="name">
                                                        <a href="#" id="dropdownName">User</a>
                                                    </h5>
                                                    <span class="email" id="dropdownEmail">user@example.com</span><br>
                                                    <small id="dropdownCabang" style="color:#777;">Cabang: -</small>
                                                </div>
                                            </div>
                                            <div class="account-dropdown__body">
                                                <div class="account-dropdown__item">
                                                    <a href="profile.html"><i class="zmdi zmdi-account"></i>Account</a>
                                                </div>
                                                <!-- <div class="account-dropdown__item">
                                                    <a href="#"><i class="zmdi zmdi-settings"></i>Setting</a>
                                                </div> -->
                                                <div class="account-dropdown__item">
                                                    <a href="#">
                                                        <i class="zmdi zmdi-settings"></i>Tema

                                                        <!-- <span id="themeLabel">Terang</span> -->
                                                        <label class="switch switch-text switch-secondary switch-pill"
                                                            style="margin-left: 5px; width: 100px;">
                                                            <input id="themeToggle" type="checkbox"
                                                                class="switch-input">
                                                            <span data-on="Gelap" data-off="Terang"
                                                                class="switch-label"></span>
                                                            <span class="switch-handle"></span>
                                                        </label>
                                                    </a>
                                                </div>



                                                <!-- <div class="account-dropdown__item">
                                                    <a href="#"><i class="zmdi zmdi-money-box"></i>Billing</a>
                                                </div> -->
                                            </div>
                                            <div class="account-dropdown__footer"
                                                style="background-color: #db3232; margin-top: -18px;">
                                                <a href="#" id="logoutBtn">
                                                    <i class="zmdi zmdi-power"></i>Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </header>
            <!-- HEADER DESKTOP-->

            <!-- MAIN CONTENT-->
            <div class="main-content">
                <div class="section__content section__content--p30">
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="overview-wrap">
                                    <h2 class="title-1">Dashboard</h2>
                                    <!-- <button class="au-btn au-btn-icon au-btn--blue">
                                        <i class="zmdi zmdi-plus"></i>add item</button> -->
                                </div>
                            </div>
                        </div>


                        <div class="row m-t-25">

                            <!-- ðŸ“… Jumlah Kontrak -->
                            <div class="col-sm-6 col-lg-3">
                                <div class="overview-item overview-item--c3"
                                    style="border-radius: 15px; overflow: hidden;">
                                    <div class="overview__inner p-3">
                                        <div class="overview-box">
                                            <div class="icon text-white">
                                                <i class="zmdi zmdi-calendar-note" style="font-size: 40px; "></i>
                                            </div>
                                            <div class="text text-white">
                                                <h2 id="jumlahKontrak" class="fw-bold mb-0 text-center"
                                                    style="margin-left: -20px; font-size: 25px;">0</h2>
                                                <span class="text-white-50" style="white-space: nowrap;">Jumlah
                                                    Kontrak</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- ðŸ“Š Jumlah Customer -->
                            <div class="col-sm-6 col-lg-3">
                                <div class="overview-item overview-item--c1"
                                    style="border-radius: 15px; overflow: hidden;">
                                    <div class="overview__inner p-3">
                                        <div class="overview-box">
                                            <div class="icon text-white">
                                                <i class="zmdi zmdi-account-o" style="font-size: 40px; "></i>
                                            </div>
                                            <div class="text text-white">
                                                <h2 id="jumlahcustomer" class="fw-bold mb-0 text-center"
                                                    style="margin-left: -20px; font-size: 25px;">0</h2>
                                                <span class="text-white-50" style="white-space: nowrap;">Jumlah
                                                    Customer</span>

                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- ðŸ›’ Items Sold -->
                            <div class="col-sm-6 col-lg-3">
                                <div class="overview-item overview-item--c2"
                                    style="border-radius: 15px; overflow: hidden;">
                                    <div class="overview__inner p-3">
                                        <div class="overview-box">
                                            <div class="icon text-white">
                                                <i class="zmdi zmdi-calendar-note"
                                                    style="font-size: 40px;"></i>
                                            </div>
                                            <div class="text text-white">
                                                <h2 class="fw-bold mb-0 text-center" id="kontrakpending"
                                                    style="margin-left: -20px; font-size: 25px;">0</h2>
                                                <span class="text-white-50"
                                                    style="white-space: nowrap; ">Kontrak Pending</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- ðŸ’° Total Earnings -->
                            <div class="col-sm-6 col-lg-3">
                                <div class="overview-item overview-item--c4"
                                    style="border-radius: 15px; overflow: hidden;">
                                    <div class="overview__inner p-3">
                                        <div class="overview-box">
                                            <div class="icon text-white">
                                                <i class="zmdi zmdi-calendar-note"
                                                    style="font-size: 40px; "></i>
                                            </div>
                                            <div class="text text-white">
                                                <h2 class="fw-bold mb-0 text-center" id="kontrakapproval"
                                                    style="margin-left: -20px; font-size: 25px;">0</h2>
                                                <span class="text-white-50"
                                                    style="white-space: nowrap; ;">Kontrak Approval</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-sm-6 col-lg-3">
                                <div class="overview-item overview-item--c3"
                                    style="border-radius: 15px; overflow: hidden;">
                                    <div class="overview__inner p-3">
                                        <div class="overview-box">
                                            <div class="icon text-white">
                                                <i class="zmdi zmdi-calendar-note" style="font-size: 40px; "></i>
                                            </div>
                                            <div class="text text-white">
                                                <h2 id="jumlahTTDSales" class="fw-bold mb-0 text-center"
                                                    style="margin-left: -20px; font-size: 25px;">0</h2>
                                                <span class="text-white-50" style="white-space: nowrap;">Jumlah
                                                    TTD Sales</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-sm-6 col-lg-3">
                                <div class="overview-item overview-item--c3"
                                    style="border-radius: 15px; overflow: hidden;">
                                    <div class="overview__inner p-3">
                                        <div class="overview-box">
                                            <div class="icon text-white">
                                                <i class="zmdi zmdi-calendar-note" style="font-size: 40px; "></i>
                                            </div>
                                            <div class="text text-white">
                                                <h2 id="jumlahTTDADH" class="fw-bold mb-0 text-center"
                                                    style="margin-left: -20px; font-size: 25px;">0</h2>
                                                <span class="text-white-50" style="white-space: nowrap;">Jumlah
                                                    TTD ADH</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-sm-6 col-lg-3">
                                <div class="overview-item overview-item--c3"
                                    style="border-radius: 15px; overflow: hidden;">
                                    <div class="overview__inner p-3">
                                        <div class="overview-box">
                                            <div class="icon text-white">
                                                <i class="zmdi zmdi-calendar-note" style="font-size: 40px; "></i>
                                            </div>
                                            <div class="text text-white">
                                                <h2 id="jumlahTTDPenjual" class="fw-bold mb-0 text-center"
                                                    style="margin-left: -20px; font-size: 25px;">0</h2>
                                                <span class="text-white-50" style="white-space: nowrap;">Jumlah
                                                    TTD Penjual</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-sm-6 col-lg-3">
                                <div class="overview-item overview-item--c3"
                                    style="border-radius: 15px; overflow: hidden;">
                                    <div class="overview__inner p-3">
                                        <div class="overview-box">
                                            <div class="icon text-white">
                                                <i class="zmdi zmdi-calendar-note" style="font-size: 40px; "></i>
                                            </div>
                                            <div class="text text-white">
                                                <h2 id="jumlahTTDPembeli" class="fw-bold mb-0 text-center"
                                                    style="margin-left: -20px; font-size: 25px;">0</h2>
                                                <span class="text-white-50" style="white-space: nowrap;">Jumlah
                                                    TTD Pembeli</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                        <div id="kontrakpercabang">
                            <div class="row mb-3">
                                <div class="col-lg-4">
                                    <select id="filterCabang" class="form-control">
                                        <option value="ADMIN">Semua Cabang</option>
                                        <option value="MAKASSAR">Makassar</option>
                                        <option value="PALU">Palu</option>
                                        <option value="BANJARMASIN">Banjarmasin</option>
                                        <option value="BALIKPAPAN">Balikpapan</option>
                                        <option value="PONTIANAK">Pontianak</option>
                                        <option value="SAMARINDA">Samarinda</option>
                                        <option value="KENDARI">Kendari</option>
                                        <option value="JAYAPURA">Jayapura</option>
                                        <option value="SORONG">Sorong</option>
                                        <!-- Tambah sesuai cabang -->
                                    </select>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-lg-12">
                                    <h2 class="title-1 m-b-25">Data Kontrak Digital Di Setiap Cabang</h2>
                                    <div class="table-responsive table--no-card m-b-40"
                                        style="max-height: 455px; overflow-y: auto;">
                                        <table class="table table-borderless table-striped table-earning"
                                            id="dataKontrakTableCabang">
                                            <thead>
                                                <tr>
                                                    <th>Nama Cabang</th>
                                                    <th>Jumlah Kontrak</th>
                                                    <th>Jumlah Customer</th>
                                                    <th>Jumlah Approval Pending</th>
                                                    <th>Jumlah Approval Diterima</th>
                                                    <th class="text-end">Jumlah TTD Sales</th>
                                                    <th class="text-end">Jumlah TTD ADH</th>
                                                    <th class="text-end">Jumlah TTD Penjual</th>
                                                    <th class="text-end">Jumlah TTD Pembeli</th>

                                                </tr>
                                            </thead>
                                            <tbody>
                                                <!-- data dari spreadsheet akan muncul di sini -->
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-lg-9">
                                <h2 class="title-1 m-b-25">Data Kontrak Digital</h2>
                                <div class="table-responsive table--no-card m-b-40"
                                    style="max-height: 455px; overflow-y: auto;">
                                    <table class="table table-borderless table-striped table-earning"
                                        id="dataKontrakTable">
                                        <thead>
                                            <tr>
                                                <th>No Perjanjian</th>
                                                <th>Tempat Perjanjian</th>
                                                <th>Tanggal Perjanjian</th>
                                                <th>Nama Perusahaan</th>
                                                <th>Status Approval</th>
                                                <th class="text-end">Status TTD Sales</th>
                                                <th class="text-end">Status TTD ADH</th>
                                                <th class="text-end">Status TTD Penjual</th>
                                                <th class="text-end">Status TTD Pembeli</th>
                                                <th class="text-end">Status Pembeli</th>
                                                <th class="text-end">Alamat Pembeli</th>
                                                <th class="text-end">No HP Pembeli</th>
                                                <th >Email Pembeli</th>
                                                <th class="text-end">Total Harga</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <!-- data dari spreadsheet akan muncul di sini -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>


                            <div class="col-lg-3">
                                <h2 class="title-1 m-b-25" style="font-size: 27px;">Tempat Perjanjian</h2>
                                <div class="au-card au-card--bg-blue au-card-top-countries m-b-40">
                                    <div class="au-card-inner">
                                        <div class="table-responsive" style="max-height: 400px; overflow-y: auto;">
                                            <table class="table table-top-countries" id="contractTable">
                                                <thead>
                                                    <tr>
                                                        <th style="background-color: #3867fd">Kota</th>
                                                        <th class="text-end" style="background-color: #2b4cff">Jumlah
                                                            Kontrak</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <!-- Data akan dimasukkan di sini -->
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-lg-6">
                                <div class="au-card recent-report">
                                    <div class="au-card-inner">
                                        <h3 class="title-2">Tempat Perjanjian Kontrak</h3>
                                        <div class="chart-info">
                                            <div class="chart-info__right">
                                                <!-- <div class="chart-statis"> -->
                                                <!-- <span class="index incre">
              <i class="zmdi zmdi-long-arrow-up"></i>25%</span>
            <span class="label">products</span> -->
                                                <!-- </div> -->
                                                <!-- <div class="chart-statis me-0"> -->
                                                <!-- <span class="index decre">
              <i class="zmdi zmdi-long-arrow-down"></i>10%</span>
            <span class="label">services</span> -->
                                                <!-- </div> -->
                                            </div>
                                        </div>
                                        <div class="recent-report__chart">
                                            <!-- Ganti canvas dengan div untuk peta -->
                                            <div id="recent-map" style="height:439px;"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Leaflet JS -->


                            <div class="col-lg-6">
                                <div class="au-card chart-percent-card">
                                    <div class="au-card-inner">
                                        <h3 class="title-2 tm-b-5">Persentase Status Customer</h3>
                                        <div class="row no-gutters">
                                            <div class="col-xl-12">
                                                <div class="percent-chart">
                                                    <canvas id="status-chart" style="height:200px;"></canvas>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>


                        <!-- <div class="row">
                            <div class="col-md-12">
                                <div class="copyright">
                                    <p>Copyright Â© 2025 Colorlib. All rights reserved. Template by <a
                                            href="https://colorlib.com" rel="nofollow" target="_blank">Colorlib</a>.</p>
                                </div>
                            </div>
                        </div> -->
                    </div>
                </div>
            </div>
            <!-- END MAIN CONTENT-->
            <!-- END PAGE CONTAINER-->
        </div>

    </div>


    <!-- Jquery JS-->
    <script src="js/vanilla-utils.js"></script>
    <!-- Bootstrap JS-->
    <script src="vendor/bootstrap-5.3.8.bundle.min.js"></script>
    <!-- Vendor JS       -->
    <script src="vendor/perfect-scrollbar/perfect-scrollbar-1.5.6.min.js"></script>
    <script src="vendor/chartjs/chart.umd.js-4.5.0.min.js"></script>


    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const user = JSON.parse(localStorage.getItem("user"));

            // Jika tidak ada user, redirect
            if (!user) {
                window.location.href = "login.html";
                return;
            }
            /* ðŸ”’ SEMBUNYIKAN MENU ACCOUNT JIKA BUKAN ADMIN */
            if ((user.role || "").toLowerCase() !== "admin") {
                const accMobile = document.getElementById("menuAccountMobile");
                const accMobile1 = document.getElementById("menuAccountMobile1");
                const accMobile2 = document.getElementById("menuAccountMobile2");
                const accDesktop = document.getElementById("menuAccountDesktop");
                const accDesktop1 = document.getElementById("menuAccountDesktop1");
                const accDesktop2 = document.getElementById("menuAccountDesktop2");

                if (accMobile) accMobile.style.display = "none";
                if (accMobile1) accMobile1.style.display = "none";
                if (accMobile2) accMobile2.style.display = "none";
                if (accDesktop) accDesktop.style.display = "none";
                if (accDesktop1) accDesktop1.style.display = "none";
                if (accDesktop2) accDesktop2.style.display = "none";
                document.getElementById("kontrakpercabang").style.display = "none";

            }


            // Tampilkan info user
            document.getElementById("userName").textContent = user.namaLengkap || "User";
            document.getElementById("dropdownName").textContent = user.namaLengkap || "User";
            document.getElementById("dropdownEmail").textContent = user.email || "-";
            document.getElementById("dropdownCabang").textContent = user.role || "-";

            if (user.avatarUrl) {
                document.getElementById("userAvatar").src = user.avatarUrl;
                document.getElementById("dropdownAvatar").src = user.avatarUrl;
            }

            // Logout
            document.getElementById("logoutBtn").addEventListener("click", function (e) {
                e.preventDefault();
                localStorage.removeItem("user");
                window.location.href = "login.html";
            });

            // =============================
            // MAPPING CABANG
            // =============================
            const accessMap = {
                "ADMIN": ["ADMIN"],
                "MAKASSAR": ["MKS", "PRE", "MMJ"],
                "PALU": ["PLU", "PGM"],
                "PAREPARE": ["PRE"],
                "MAMUJU": ["MMJ"],
                "BULUNGAN": ["BLG"],
                "KENDARI": ["KDR"],
                "SORONG": ["SOR"],
                "GORONTALO": ["GTL"],
                "CILEGON": ["CLG"],
                "JAYAPURA": ["JPR"],
                "SAMARINDA": ["SMD"],
                "PONTIANAK": ["PTK"],
                "BANJARMASIN": ["BJM"],
                "BALIKPAPAN": ["BPP"]
            };

            const cabangUser = user.role ? user.role.toUpperCase() : "ADMIN";
            const allowedCodes = accessMap[cabangUser] || [cabangUser];

            console.log("Login sebagai:", cabangUser, "â†’ Akses:", allowedCodes);

            // Fungsi filter berdasarkan cabang
            function filterByCabang(data, key = "noperjanjian") {
                if (allowedCodes.includes("ADMIN")) return data; // ADMIN full akses
                return data.filter(row => {
                    const val = (row[key] || "").toUpperCase();
                    return allowedCodes.some(code => val.includes(code));
                });
            }

            // =============================
            // LOAD DASHBOARD (SEMUA IKUT FILTER)
            // =============================
            async function loadDashboardFiltered() {
                try {
                    let res = await fetch(
                        "https://script.google.com/macros/s/AKfycbwyutAXOuSEfy1yItsWsWNCPBzOqyI-lktXPUdizX3H05Bj-syHkbrUIIbWWPGvXDBI8Q/exec?mode=tabeldata"
                    );
                    let data = await res.json();

                    // Filter data sesuai cabang
                    let filtered = filterByCabang(data, "noperjanjian");

                    // ==============================
// 4ï¸âƒ£ Jumlah Kontrak Pending & Approval
// ==============================

// Pending = statusApproval kosong ATAU PENDING
let jumlahKontrakPending = filtered.filter(x => {
    const s = String(x.statusApproval || "").trim().toUpperCase();
    return s === "" || s === "PENDING";
}).length;

// Approval = statusApproval DITERIMA
let jumlahKontrakApproval = filtered.filter(x => {
    const s = String(x.statusApproval || "").trim().toUpperCase();
    return s === "DITERIMA";
}).length;

document.getElementById("kontrakpending").innerText =
    jumlahKontrakPending.toLocaleString("id-ID");

document.getElementById("kontrakapproval").innerText =
    jumlahKontrakApproval.toLocaleString("id-ID");


                    // ==============================
                    // 1ï¸âƒ£ Jumlah Kontrak
                    // ==============================
                    document.getElementById("jumlahKontrak").innerText =
                        filtered.length.toLocaleString("id-ID");

                    // ==============================
                    // 2ï¸âƒ£ Jumlah TTD Sales (HANYA Sudah TTD)
                    // ==============================
                    let jumlahTTDSales = filtered.filter(x =>
                        String(x.status_sales || "").toLowerCase().includes("sudah")
                    ).length;

                    document.getElementById("jumlahTTDSales").innerText =
                        jumlahTTDSales.toLocaleString("id-ID");

                    let jumlahTTDADH = filtered.filter(x =>
                        String(x.status_adh || "").toLowerCase().includes("sudah")
                    ).length;

                    document.getElementById("jumlahTTDADH").innerText =
                        jumlahTTDADH.toLocaleString("id-ID");

                    let jumlahTTDPenjual = filtered.filter(x =>
                        String(x.status_penjual || "").toLowerCase().includes("sudah")
                    ).length;

                    document.getElementById("jumlahTTDPenjual").innerText =
                        jumlahTTDPenjual.toLocaleString("id-ID");

                    let jumlahTTDPembeli = filtered.filter(x =>
                        String(x.status_pembeli || "").toLowerCase().includes("sudah")
                    ).length;

                    document.getElementById("jumlahTTDPembeli").innerText =
                        jumlahTTDPembeli.toLocaleString("id-ID");

                    // ==============================
                    // 3ï¸âƒ£ Jumlah Customer Unik
                    // ==============================
                    const customers = new Set(
                        filtered.map(x => x.emailpembeli || x.nohppembeli)
                    );

                    document.getElementById("jumlahcustomer").innerText =
                        customers.size.toLocaleString("id-ID");


                } catch (err) {
                    console.error("Gagal load dashboard:", err);
                }
            }


            loadDashboardFiltered();  // jalankan setelah login
            setInterval(loadDashboardFiltered, 5000);
        });
    </script>

    <!-- Leaflet CSS dan JS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <script>
        const user = JSON.parse(localStorage.getItem("user"));

        const accessMap = {
            "ADMIN": ["ADMIN"],
            "MAKASSAR": ["MKS", "PRE", "MMJ"],
            "PALU": ["PLU", "PGM"],
            "PAREPARE": ["PRE"],
            "MAMUJU": ["MMJ"],
            "BULUNGAN": ["BLG"],
            "KENDARI": ["KDR"],
            "SORONG": ["SOR"],
            "GORONTALO": ["GTL"],
            "CILEGON": ["CLG"],
            "JAYAPURA": ["JPR"],
            "SAMARINDA": ["SMD"],
            "PONTIANAK": ["PTK"],
            "BANJARMASIN": ["BJM"],
            "BALIKPAPAN": ["BPP"]
        };

        const cabangUser = user && user.role ? user.role.toUpperCase() : "ADMIN";
        const allowedCodes = accessMap[cabangUser] || [cabangUser];

        console.log("Login:", cabangUser, "Akses:", allowedCodes);

        function filterPerjanjian(data, key = "noperjanjian") {
            if (allowedCodes.includes("ADMIN")) return data;
            return data.filter(row => {
                const val = (row[key] || "").toUpperCase();
                return allowedCodes.some(code => val.includes(code));
            });
        }
    </script>


    <script>
        const scriptURL = "https://script.google.com/macros/s/AKfycbwyutAXOuSEfy1yItsWsWNCPBzOqyI-lktXPUdizX3H05Bj-syHkbrUIIbWWPGvXDBI8Q/exec";

        const ALL_CABANG = [
            "MAKASSAR", "PALU",
            "BULUNGAN", "KENDARI", "SORONG", "GORONTALO",
            "CILEGON", "JAYAPURA", "SAMARINDA", "PONTIANAK",
            "BANJARMASIN", "BALIKPAPAN"
        ];

        // Load data API
        async function loadDataCabang(cabang) {
            const res = await fetch(`${scriptURL}?mode=status&cabang=${cabang}`);
            return await res.json();
        }

        // ==============================
        // RENDER UNTUK ADMIN (banyak baris)
        // ==============================
        async function renderAdminTable() {
            const tbody = document.querySelector("#dataKontrakTableCabang tbody");
            tbody.innerHTML = "";

            for (const cabang of ALL_CABANG) {
                const data = await loadDataCabang(cabang);

                const totalKontrak = data.length;
                const totalCustomer = new Set(data.map(d => d.nama_perusahaan)).size;
                
      
                let ttdSales = 0, ttdADH = 0, ttdPenjual = 0, ttdPembeli = 0;
                let approvalPending = 0;
let approvalDiterima = 0;


                // data.forEach(item => {
                //     const sSales = (item.status_sales || "").toLowerCase();
                //     const sADH = (item.status_adh || "").toLowerCase();
                //     const sPenjual = (item.status_penjual || "").toLowerCase();
                //     const sPembeli = (item.status_pembeli || "").toLowerCase();

                //     if (sSales.includes("sudah")) ttdSales++;
                //     if (sADH.includes("sudah")) ttdADH++;
                //     if (sPenjual.includes("sudah")) ttdPenjual++;
                //     if (sPembeli.includes("sudah")) ttdPembeli++;
                // });
                data.forEach(item => {
    const sSales = (item.status_sales || "").toLowerCase();
    const sADH = (item.status_adh || "").toLowerCase();
    const sPenjual = (item.status_penjual || "").toLowerCase();
    const sPembeli = (item.status_pembeli || "").toLowerCase();

    const rawApproval = (item.statusApproval || "").toString().trim().toUpperCase();

    if (sSales.includes("sudah")) ttdSales++;
    if (sADH.includes("sudah")) ttdADH++;
    if (sPenjual.includes("sudah")) ttdPenjual++;
    if (sPembeli.includes("sudah")) ttdPembeli++;

    // âœ… LOGIKA APPROVAL
    if (rawApproval === "DITERIMA") {
    approvalDiterima++;
} else if (rawApproval === "PENDING" || rawApproval === "" || rawApproval === "-") {
    approvalPending++;
}

});


                tbody.innerHTML += `
            <tr>
                <td>${cabang}</td>
                <td>${totalKontrak}</td>
                <td>${totalCustomer}</td>
                <td>${approvalPending}</td>
    <td>${approvalDiterima}</td>
                <td >${ttdSales}</td>
                <td >${ttdADH}</td>
                <td >${ttdPenjual}</td>
                <td >${ttdPembeli}</td>
            </tr>
        `;
            }
        }

        // ==============================
        // RENDER UNTUK USER (hanya satu baris)
        // ==============================
        function renderTableCabang(data, cabang) {
            const tbody = document.querySelector("#dataKontrakTableCabang tbody");
            tbody.innerHTML = "";

            const totalKontrak = data.length;
            const totalCustomer = new Set(data.map(d => d.nama_perusahaan)).size;
           



            let ttdSales = 0, ttdADH = 0, ttdPenjual = 0, ttdPembeli = 0;
            let approvalPending = 0;
let approvalDiterima = 0;


            // data.forEach(item => {
            //     const sSales = (item.status_sales || "").toLowerCase();
            //     const sADH = (item.status_adh || "").toLowerCase();
            //     const sPenjual = (item.status_penjual || "").toLowerCase();
            //     const sPembeli = (item.status_pembeli || "").toLowerCase();

            //     if (sSales.includes("sudah")) ttdSales++;
            //     if (sADH.includes("sudah")) ttdADH++;
            //     if (sPenjual.includes("sudah")) ttdPenjual++;
            //     if (sPembeli.includes("sudah")) ttdPembeli++;
            // });
            data.forEach(item => {
    const sSales = (item.status_sales || "").toLowerCase();
    const sADH = (item.status_adh || "").toLowerCase();
    const sPenjual = (item.status_penjual || "").toLowerCase();
    const sPembeli = (item.status_pembeli || "").toLowerCase();

    const rawApproval = (item.statusApproval || "").toString().trim().toUpperCase();

    if (sSales.includes("sudah")) ttdSales++;
    if (sADH.includes("sudah")) ttdADH++;
    if (sPenjual.includes("sudah")) ttdPenjual++;
    if (sPembeli.includes("sudah")) ttdPembeli++;

    // âœ… LOGIKA APPROVAL
    if (rawApproval === "DITERIMA") {
    approvalDiterima++;
} else if (rawApproval === "PENDING" || rawApproval === "" || rawApproval === "-") {
    approvalPending++;
}

});


            tbody.innerHTML = `
        <tr>
            <td>${cabang}</td>
            <td>${totalKontrak}</td>
            <td>${totalCustomer}</td>
            <td>${approvalPending}</td>
            <td>${approvalDiterima}</td>
            <td >${ttdSales}</td>
            <td >${ttdADH}</td>
            <td >${ttdPenjual}</td>
            <td >${ttdPembeli}</td>
        </tr>
    `;
        }

        // ==============================
        // EVENT DROPDOWN (ADMIN & USER)
        // ==============================
        document.getElementById("filterCabang").addEventListener("change", async function () {
            const cabang = this.value;
            const user = JSON.parse(localStorage.getItem("user")) || {};

            if ((user.role || "").toLowerCase() === "admin") {
                if (cabang === "ADMIN") {
                    renderAdminTable();   // ðŸ”¥ tampilkan tabel banyak baris
                } else {
                    const data = await loadDataCabang(cabang);
                    renderTableCabang(data, cabang); // ðŸ”¥ hanya satu cabang
                }
            } else {
                // User biasa
                const data = await loadDataCabang(cabang);
                renderTableCabang(data, cabang);
            }
            
        });

        // ==============================
        // LOAD AWAL
        // ==============================
        document.addEventListener("DOMContentLoaded", async () => {

            const user = JSON.parse(localStorage.getItem("user")) || {};

            if ((user.role || "").toLowerCase() === "admin") {
                renderAdminTable();
            } else {
                const cabang = document.getElementById("filterCabang").value;
                const data = await loadDataCabang(cabang);
                renderTableCabang(data, cabang);
            }
        });
    </script>




    <script>
        const map = L.map('recent-map').setView([-2.5489, 118.0149], 5);

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; OpenStreetMap contributors'
        }).addTo(map);

        const mapUrl = "https://script.google.com/macros/s/AKfycbwyutAXOuSEfy1yItsWsWNCPBzOqyI-lktXPUdizX3H05Bj-syHkbrUIIbWWPGvXDBI8Q/exec?mode=tabeldata";

        async function getCoordinates(city) {
            const res = await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${city}+Indonesia`);
            const result = await res.json();
            return result.length ? { lat: parseFloat(result[0].lat), lng: parseFloat(result[0].lon) } : null;
        }

        async function loadMapFiltered() {
            const res = await fetch(mapUrl);
            const data = await res.json();

            const filtered = filterPerjanjian(data);

            const countPerCity = {};
            filtered.forEach(item => {
                const city = item.tempatperjanjian ?? "Tidak diketahui";
                countPerCity[city] = (countPerCity[city] || 0) + 1;
            });

            for (const city in countPerCity) {
                const coords = await getCoordinates(city);
                if (coords) {
                    L.circle([coords.lat, coords.lng], {
                        radius: countPerCity[city] * 600,
                        color: 'blue',
                        fillColor: '#3399ff',
                        fillOpacity: 0.4
                    }).addTo(map).bindPopup(`<b>${city}</b><br>${countPerCity[city]} kontrak`);
                }
            }
        }

        loadMapFiltered();
        setInterval(loadMapFiltered, 15000);
    </script>
    <script>
        const dataUrl3 = "https://script.google.com/macros/s/AKfycbwyutAXOuSEfy1yItsWsWNCPBzOqyI-lktXPUdizX3H05Bj-syHkbrUIIbWWPGvXDBI8Q/exec?mode=tabeldata";

        async function loadStatusChart() {
            const response = await fetch(dataUrl3);
            const rawData = await response.json();

            // pastikan filter function tersedia
            const filteredData = typeof filterPerjanjian === "function"
                ? filterPerjanjian(rawData)
                : rawData;

            // === NORMALISASI & HITUNG ===
            const counts = { BARU: 0, LAMA: 0 };

            filteredData.forEach(item => {
                const status = (item.statuspembeli || "").trim().toUpperCase();
                if (counts[status] !== undefined) counts[status]++;
            });

            const labels = ["Baru", "Lama"];
            const values = [counts.BARU, counts.LAMA];

            console.log("HASIL FILTER:", filteredData);
            console.log("COUNT STATUS:", values);
           


            // Hapus chart lama jika ada (menghindari duplikasi)
            if (window.statusChart instanceof Chart) {
                window.statusChart.destroy();
            }

            const ctx = document.getElementById('status-chart').getContext('2d');
            window.statusChart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: labels,
                    datasets: [{
                        data: values,
                        backgroundColor: ['#36A2EB', '#FF6384']
                    }]
                },
                options: {
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function (context) {
                                    const value = context.raw;
                                    const total = values.reduce((a, b) => a + b, 0) || 1;
                                    const percent = ((value / total) * 100).toFixed(1);
                                    return `${context.label}: ${value} (${percent}%)`;
                                }
                            }
                        },
                        legend: { position: 'bottom' }
                    }
                }
            });
        }

        loadStatusChart();
        setInterval(loadStatusChart, 15000);
    </script>

    <script>
        async function loadContractTable() {
            const res = await fetch(mapUrl);
            const data = await res.json();
            const filtered = filterPerjanjian(data);

            const cityCount = {};
            filtered.forEach(item => {
                const kota = item.tempatperjanjian || "Tidak diketahui";
                cityCount[kota] = (cityCount[kota] || 0) + 1;
            });

            const sorted = Object.entries(cityCount).sort((a, b) => b[1] - a[1]);

            const tbody = document.querySelector("#contractTable tbody");
            tbody.innerHTML = "";

            sorted.forEach(([city, count]) => {
                const tr = document.createElement("tr");
                tr.innerHTML = `<td>${city}</td><td class="text-end">${count}</td>`;
                tbody.appendChild(tr);
            });
        }

        loadContractTable();
        setInterval(loadContractTable, 10000);
    </script>
    <script>
        async function loadDataKontrak() {
            const res = await fetch(mapUrl);
            const data = await res.json();
            const filtered = filterPerjanjian(data);

            const tbody = document.querySelector("#dataKontrakTable tbody");
            tbody.innerHTML = "";

            filtered.forEach(item => {
                const date = item.tanggalperjanjian ? new Date(item.tanggalperjanjian).toLocaleDateString("id-ID") : "-";
                const tr = document.createElement("tr");
                tr.innerHTML = `
            <td>${item.noperjanjian || "-"}</td>
            <td>${item.tempatperjanjian || "-"}</td>
            <td>${date}</td>
            <td>${item.namaperusahaan || "-"}</td>
            <td class="text-center">${item.statusApproval || "PENDING"}</td>
            <td class="text-center">${item.status_sales || "-"}</td>
            <td class="text-center">${item.status_adh || "-"}</td>
            <td class="text-center">${item.status_penjual || "-"}</td>
            <td class="text-center">${item.status_pembeli || "-"}</td>
            <td>${item.statuspembeli || "-"}</td>
            <td >${item.alamatpembeli || "-"}</td>
            <td >${item.nohppembeli || "-"}</td>
            <td >${item.emailpembeli || "-"}</td>
            
            <td >${item.totalharga || "-"}</td>
        `;
                tbody.appendChild(tr);
            });
        }

        loadDataKontrak();
        setInterval(loadDataKontrak, 10000);
    </script>


    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const themeToggle = document.getElementById("themeToggle");

            // Ambil tema dari localStorage
            const currentTheme = localStorage.getItem("theme") || "light";

            // Set awal tema
            if (currentTheme === "dark") {
                document.body.classList.add("dark-mode");
                themeToggle.checked = true;
            } else {
                document.body.classList.remove("dark-mode");
                themeToggle.checked = false;
            }

            // Event ketika switch diubah
            themeToggle.addEventListener("change", function () {
                if (themeToggle.checked) {
                    document.body.classList.add("dark-mode");
                    localStorage.setItem("theme", "dark");
                } else {
                    document.body.classList.remove("dark-mode");
                    localStorage.setItem("theme", "light");
                }
            });
        });
    </script>









    <!-- Main JS-->
    <script src="js/bootstrap5-init.js"></script>
    <script src="js/main-vanilla.js"></script>
    <script src="js/swiper-bundle-11.2.10.min.js"></script>
    <script src="js/aos.js"></script>
    <script src="js/modern-plugins.js"></script>


</body>

</html>
<!-- end document-->